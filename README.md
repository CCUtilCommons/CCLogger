# CCLogger

ä¸€ä¸ªåŸºäº **C++17** çš„é«˜æ€§èƒ½æ—¥å¿—åº“ï¼Œé¢å‘é«˜å¹¶å‘åœºæ™¯è®¾è®¡ã€‚  
å®ƒæ”¯æŒå¯æ’æ‹”çš„æ—¥å¿—æ ¼å¼åŒ–å™¨ä¸è¾“å‡ºåç«¯ï¼Œå¹¶é€šè¿‡çº¿ç¨‹æ± é©±åŠ¨å®ç°å¼‚æ­¥å†™å…¥ã€‚  

### ç‰¹æ€§
- ğŸ”Œ **å¯æ’æ‹”åç«¯**ï¼šæ”¯æŒ `LoggerIO` åŠ¨æ€æ³¨å†Œ/ç§»é™¤ï¼ˆæ–‡ä»¶/æ§åˆ¶å°/è‡ªå®šä¹‰ï¼‰  
- ğŸ§µ **å¼‚æ­¥çº¿ç¨‹æ± **ï¼šæ—¥å¿—å†™å…¥ä¸ä¸šåŠ¡çº¿ç¨‹è§£è€¦ï¼Œæå‡å¹¶å‘åå  
- ğŸ“¡ **å¤šåç«¯å¹¿æ’­**ï¼šä¸€æ¡æ—¥å¿—å¯åŒæ—¶å†™å…¥å¤šä¸ªåç«¯  
- ğŸ“ **æºä½ç½®ä¿¡æ¯**ï¼šè‡ªåŠ¨æ•è·æ–‡ä»¶ã€è¡Œå·ã€å‡½æ•°å  
- âš¡ **é«˜ååæ€§èƒ½**ï¼šå•æœºå¯è¾¾ 20W+ logs/secï¼ˆå¤šçº¿ç¨‹ä¸‹ï¼‰
---

## æ¥å£è¯´æ˜

### å…¬å…±æ–¹æ³•ä¸€è§ˆ

| æ–¹æ³• | å‚æ•° | è¯´æ˜ |
|------|------|------|
| `CCLogger()` | - | ä½¿ç”¨é»˜è®¤æ ¼å¼åŒ–å™¨ä¸è¾“å‡ºåç«¯æ„é€  |
| `CCLogger(std::unique_ptr<LoggerFormatter>, std::unique_ptr<LoggerIO>)` | `formater`ï¼šæ—¥å¿—æ ¼å¼åŒ–å™¨<br>`default_io`ï¼šé»˜è®¤è¾“å‡ºåç«¯ | è‡ªå®šä¹‰æ„é€ å™¨ |
| `void log(const std::string&, CCLoggerLevel, std::source_location)` | `msg`ï¼šæ—¥å¿—å†…å®¹<br>`level`ï¼šæ—¥å¿—çº§åˆ«<br>`loc`ï¼šæºä½ç½®ä¿¡æ¯ | æ‰“å°æ—¥å¿—ï¼ˆæ‹·è´å­—ç¬¦ä¸²ï¼‰ |
| `void log(std::string&&, CCLoggerLevel, std::source_location)` | åŒä¸Š | æ‰“å°æ—¥å¿—ï¼ˆå³å€¼å¼•ç”¨ï¼Œé¿å…æ‹·è´ï¼‰ |
| `void registerIOBackEnd(std::unique_ptr<LoggerIO>)` | `backend`ï¼šæ–°çš„æ—¥å¿—åç«¯ | åŠ¨æ€æ³¨å†Œé¢å¤–è¾“å‡º |
| `bool removeIOBackEnd(LoggerIO* backend)` | `backend`ï¼šå¾…ç§»é™¤çš„åç«¯æŒ‡é’ˆ | ç§»é™¤æ—¥å¿—åç«¯ï¼Œè¿”å›æ˜¯å¦æˆåŠŸ |
| `bool defBackendSilent() const` | - | è·å–æ˜¯å¦å±è”½é»˜è®¤åç«¯ |
| `void setDefBackendSilent(bool)` | `true/false` | è®¾ç½®æ˜¯å¦å±è”½é»˜è®¤åç«¯ |

---

## ä½¿ç”¨ç¤ºä¾‹

```cpp
#include "CCLogger.hpp"
#include "io/fileio.h"
#include "formater.h"

using namespace Clog;

int main() {
    CCLogger logger;

    logger.registerIOBackEnd(std::make_unique<FileLoggerIO>("app.log"));

    logger.log("Hello CCLogger", CCLoggerLevel::INFO);
    logger.log("Something went wrong", CCLoggerLevel::ERROR);

    logger.setDefBackendSilent(true);
}
```

æ›´å¤šçš„æ ·ä¾‹å¯ä»¥å‚è€ƒexampleæ–‡ä»¶å¤¹ä¸‹çš„exampleä»£ç ï¼


## æ€§èƒ½è¡¨ç°
### FileLoggerIOï¼ˆå†™æ–‡ä»¶ï¼‰
| threads | tasks_per_thread | total_tasks | time_s | tps     |
| ------- | ---------------- | ----------- | ------ | ------- |
| 1       | 200000           | 200000      | 8.72   | 22930.8 |
| 2       | 100000           | 200000      | 1.53   | 130427  |
| 4       | 50000            | 200000      | 1.39   | 143774  |
| 8       | 25000            | 200000      | 1.34   | 149706  |
| 16      | 12500            | 200000      | 0.97   | 206795  |
| 32      | 6250             | 200000      | 0.82   | 244265  |

### NullLoggerIOï¼ˆä¸¢å¼ƒæ—¥å¿—ï¼‰

| threads | tasks_per_thread | total_tasks | time_s | tps     |
| ------- | ---------------- | ----------- | ------ | ------- |
| 1       | 1000000          | 1000000     | 43.27  | 23111.5 |
| 2       | 500000           | 1000000     | 7.33   | 136434  |
| 4       | 250000           | 1000000     | 6.84   | 146301  |
| 8       | 125000           | 1000000     | 6.57   | 152173  |
| 16      | 62500            | 1000000     | 4.81   | 207910  |
| 32      | 31250            | 1000000     | 3.68   | 272075  |
| 64      | 15625            | 1000000     | 3.82   | 262104  |